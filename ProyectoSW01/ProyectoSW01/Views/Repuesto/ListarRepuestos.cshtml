@model IEnumerable<ProyectoSW01.Models.Repuesto>

@{
    ViewData["Title"] = "Listado de Repuestos";
}

<!-- Tailwind CSS -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Material Icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

<!-- jQuery (DataTables 2.x) -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<!-- DataTables -->
<link rel="stylesheet"
      href="https://cdn.datatables.net/2.1.3/css/dataTables.dataTables.min.css" />
<script src="https://cdn.datatables.net/2.1.3/js/dataTables.min.js"></script>

<div class="max-w-6xl mx-auto px-4 py-8">

    <!-- TÍTULO + BOTÓN -->
    <div class="flex items-center justify-between mb-6">
        <h1 class="text-3xl font-bold text-gray-800 flex items-center gap-2">
            <span class="material-icons text-orange-500">inventory_2</span>
            Listado de Repuestos
        </h1>

        <a asp-action="Create"
           class="inline-flex items-center gap-2 bg-blue-700 text-white px-5 py-2.5 rounded-xl
                  hover:bg-blue-800 shadow-md hover:shadow-lg transition text-sm">
            <span class="material-icons text-white">add</span>
            Nuevo Repuesto
        </a>
    </div>

    <!-- Buscador DataTables -->
    <div class="flex justify-center mb-6">
        <div class="w-full max-w-md relative">
            <input id="tablaBuscador"
                   type="text"
                   placeholder="Buscar repuesto por nombre, precio, stock..."
                   class="w-full px-4 py-2 pl-10 border border-gray-300 rounded-xl shadow-sm
                          focus:ring-2 focus:ring-orange-400 focus:border-orange-400 outline-none" />
            <span class="material-icons absolute left-2 top-2.5 text-gray-400">
                search
            </span>
        </div>
    </div>

    <!-- TABLA -->
    <div class="bg-white shadow rounded-xl overflow-x-auto p-3">

        <table id="repuestosTable" class="display w-full text-sm">
            <thead class="bg-blue-500 text-white text-sm">
                <tr>
                    <th class="px-4 py-3 text-left">ID</th>
                    <th class="px-4 py-3 text-left">Nombre</th>
                    <th class="px-4 py-3 text-left">Descripción</th>
                    <th class="px-4 py-3 text-left">Precio</th>
                    <th class="px-4 py-3 text-left">Stock</th>
                    <th class="px-4 py-3 text-center">Acciones</th>
                </tr>
            </thead>

            <tbody class="text-gray-700">
                @foreach (var item in Model)
                {
                    <tr class="hover:bg-gray-50 transition">
                        <td class="px-4 py-3">@item.RepuestoId</td>

                        <td class="px-4 py-3 font-semibold">@item.Nombre</td>

                        <td class="px-4 py-3">
                            @(
                                                    !string.IsNullOrWhiteSpace(item.Descripcion) && item.Descripcion.Length > 60
                                                    ? item.Descripcion.Substring(0, 60) + "..."
                                                    : item.Descripcion
                                                    )
                    </td>

                        <td class="px-4 py-3">@item.Precio.ToString("C")</td>

                        <td class="px-4 py-3">@item.Stock</td>

                        <td class="px-4 py-3 text-center">
                            <div class="flex justify-center gap-3">

                                <!-- Editar -->
                                <a asp-action="Edit" asp-route-id="@item.RepuestoId"
                                   class="text-yellow-600 hover:text-yellow-800">
                                    <span class="material-icons text-lg">edit</span>
                                </a>

                                <!-- Detalles -->
                                <a asp-action="Details" asp-route-id="@item.RepuestoId"
                                   class="text-blue-600 hover:text-blue-800">
                                    <span class="material-icons text-lg">visibility</span>
                                </a>

                                <!-- Eliminar -->
                                <a asp-action="Delete" asp-route-id="@item.RepuestoId"
                                   class="text-red-600 hover:text-red-800">
                                    <span class="material-icons text-lg">delete</span>
                                </a>

                            </div>
                        </td>

                    </tr>
                                }
            </tbody>
        </table>

    </div>

    <!-- BOTÓN MENU -->
    <div class="mt-6 flex justify-center">
        <a asp-action="MenuRepuestos"
           class="inline-flex items-center gap-2 bg-slate-800 text-white px-5 py-2 rounded-xl
                  hover:bg-slate-700 shadow-md text-sm">
            <span class="material-icons text-base">arrow_back</span>
            Menú de Repuestos
        </a>
    </div>

</div>

<script>
    let table;

    $(document).ready(function () {

        table = new DataTable('#repuestosTable', {
            language: {
                url: 'https://cdn.datatables.net/plug-ins/2.1.3/i18n/es-ES.json'
            },
            pageLength: 10,
            lengthMenu: [5, 10, 25, 50, 100],
            order: [[0, 'desc']]
        });

        $('#tablaBuscador').on('input', function () {
            table.search(this.value).draw();
        });

    });
</script>
