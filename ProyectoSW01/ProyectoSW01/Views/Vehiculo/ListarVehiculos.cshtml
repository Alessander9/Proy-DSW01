@model IEnumerable<ProyectoSW01.Models.Vehiculo>

@{
    ViewData["Title"] = "Vehículos Registrados";
}

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Icons (Material Symbols Rounded) -->
<link rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:wght@300;400;700&display=swap" />

<!-- jQuery (requerido por DataTables 2.x) -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<!-- DataTables 2.x -->
<link rel="stylesheet"
      href="https://cdn.datatables.net/2.1.3/css/dataTables.dataTables.min.css" />
<script src="https://cdn.datatables.net/2.1.3/js/dataTables.min.js"></script>

<div class="max-w-7xl mx-auto px-4 py-8">

    <!-- Título + botón -->
    <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-6">
        <h1 class="text-3xl font-bold text-gray-800">Vehículos Registrados</h1>

        <a asp-action="Create"
           class="inline-flex items-center bg-blue-600 text-white px-5 py-2 rounded-xl
                  hover:bg-blue-700 shadow transition gap-2">
            <span class="material-symbols-rounded">add</span> Registrar Vehículo
        </a>
    </div>

    <!-- Buscador personalizado -->
    <div class="flex justify-center mb-6">
        <div class="relative w-full max-w-md">
            <input id="tablaBuscador" type="text"
                   placeholder="Buscar vehículo o cliente..."
                   class="w-full px-4 py-2 pl-10 border rounded-xl shadow-sm focus:ring-2 focus:ring-blue-400 outline-none" />
            <span class="material-symbols-rounded absolute left-2 top-2.5 text-gray-400">search</span>
        </div>
    </div>

    <!-- Tabla -->
    <div class="overflow-x-auto bg-white shadow-xl rounded-2xl border p-3">
        <table id="vehiculosTable" class="display w-full text-sm">
            <thead class="bg-gray-100 text-gray-700">
                <tr>
                    <th>ID</th>
                    <th>Cliente</th>
                    <th>Marca</th>
                    <th>Modelo</th>
                    <th>Año</th>
                    <th>Placa</th>
                    <th class="text-center">Acciones</th>
                </tr>
            </thead>

            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td>@item.VehiculoId</td>
                        <td>@item.ClienteNombreCompleto</td>
                        <td>@item.Marca</td>
                        <td>@item.Modelo</td>
                        <td>@item.Anio</td>
                        <td>@item.Placa</td>
                        <td class="text-center">
                            <div class="flex justify-center gap-2">
                                <a asp-action="Details" asp-route-id="@item.VehiculoId"
                                   class="text-green-600 hover:text-green-800">
                                    <span class="material-symbols-rounded">visibility</span>
                                </a>
                                <a asp-action="Edit" asp-route-id="@item.VehiculoId"
                                   class="text-blue-600 hover:text-blue-800">
                                    <span class="material-symbols-rounded">edit</span>
                                </a>
                                <a asp-action="Delete" asp-route-id="@item.VehiculoId"
                                   class="text-red-600 hover:text-red-800">
                                    <span class="material-symbols-rounded">delete</span>
                                </a>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Botón volver (opcional, igual que clientes) -->
    <div class="mt-6 flex justify-center">
        <a asp-action="MenuVehiculo"
           class="inline-flex items-center gap-2 bg-slate-800 text-white px-5 py-2 rounded-xl hover:bg-slate-700">
            <span class="material-symbols-rounded">arrow_back</span>
            Menú de Vehículos
        </a>
    </div>
</div>

<script>
    let table;

    $(document).ready(function () {

        // Inicializar DataTables 2.x correctamente
        table = new DataTable('#vehiculosTable', {
            language: {
                url: 'https://cdn.datatables.net/plug-ins/2.1.3/i18n/es-ES.json'
            },
            pageLength: 10,
            lengthMenu: [5, 10, 25, 50, 100],
            order: [[0, 'desc']]
        });

        // Buscador personalizado EN TIEMPO REAL
        $('#tablaBuscador').on('input', function () {
            table.search(this.value).draw();
        });
    });
</script>
