@model IEnumerable<ProyectoSW01.Models.Usuario>

@{
    ViewData["Title"] = "Listar Usuarios";
}



<!-- Tailwind CDN -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Material Icons CDN -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

<!-- jQuery (para DataTables) -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<!-- DataTables 2.x -->
<link rel="stylesheet"
      href="https://cdn.datatables.net/2.1.3/css/dataTables.dataTables.min.css" />
<script src="https://cdn.datatables.net/2.1.3/js/dataTables.min.js"></script>

<div class="max-w-6xl mx-auto px-4 py-8">

    <!-- Título + botón -->
    <div class="flex items-center justify-between mb-6">
        <h1 class="text-3xl font-bold text-gray-800 flex items-center gap-2">
            <span class="material-icons text-blue-700">group</span>
            Lista de Usuarios
        </h1>

        <a asp-action="Create"
           class="inline-flex items-center gap-2 bg-blue-700 text-white px-5 py-2.5 rounded-xl
                  hover:bg-blue-800 shadow-md hover:shadow-lg transition text-sm">
            <span class="material-icons text-sm">add</span>
            Nuevo Usuario
        </a>
    </div>

    <!-- Buscador DataTables -->
    <div class="flex justify-center mb-6">
        <div class="w-full max-w-md relative">
            <input id="tablaBuscador"
                   type="text"
                   placeholder="Buscar usuarios por nombre, correo o rol..."
                   class="w-full px-4 py-2 pl-10 border border-gray-300 rounded-xl shadow-sm
                          focus:ring-2 focus:ring-blue-400 focus:border-blue-400 outline-none" />
            <span class="material-icons absolute left-2 top-2.5 text-gray-400">
                search
            </span>
        </div>
    </div>

    <!-- Tabla -->
    <div class="overflow-x-auto bg-white rounded-xl shadow p-3">
        <table id="usuariosTable" class="min-w-full divide-y divide-gray-200 text-sm display">
            <thead class="bg-blue-700 text-white">
                <tr>
                    <th class="px-4 py-3 text-left font-semibold">ID</th>
                    <th class="px-4 py-3 text-left font-semibold">Nombre Completo</th>
                    <th class="px-4 py-3 text-left font-semibold">Correo</th>
                    <th class="px-4 py-3 text-left font-semibold">Rol (ID)</th>
                    <th class="px-4 py-3 text-center font-semibold">Acciones</th>
                </tr>
            </thead>

            <tbody class="divide-y divide-gray-200 text-gray-700">
                @foreach (var item in Model)
                {
                    <tr class="hover:bg-gray-50 transition">
                        <td class="px-4 py-3">@item.IdUsuario</td>
                        <td class="px-4 py-3">@item.NombreCompleto</td>
                        <td class="px-4 py-3">@item.Correo</td>
                        <td class="px-4 py-3">@item.IdRol</td>

                        <td class="px-4 py-3 text-center">
                            <div class="flex justify-center gap-2">

                                <!-- Edit -->
                                <a asp-action="Edit" asp-route-id="@item.IdUsuario"
                                   class="text-blue-700 hover:text-blue-900 inline-flex items-center px-2 py-1 rounded">
                                    <span class="material-icons text-base">edit</span>
                                </a>

                                <!-- Details -->
                                <a asp-action="Details" asp-route-id="@item.IdUsuario"
                                   class="text-green-700 hover:text-green-900 inline-flex items-center px-2 py-1 rounded">
                                    <span class="material-icons text-base">visibility</span>
                                </a>

                                <!-- Delete -->
                                <a asp-action="Delete" asp-route-id="@item.IdUsuario"
                                   class="text-red-600 hover:text-red-800 inline-flex items-center px-2 py-1 rounded">
                                    <span class="material-icons text-base">delete</span>
                                </a>

                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Botón Menú Usuarios -->
    <div class="mt-6 flex justify-center">
        <a asp-action="MenuUsuario"
           class="inline-flex items-center gap-2 bg-slate-800 text-white px-5 py-2 rounded-xl
                  hover:bg-slate-700 shadow-md text-sm">
            <span class="material-icons text-base">arrow_back</span>
            Menú de Usuarios
        </a>
    </div>

</div>

<script>
    let tablaUsuarios;

    $(document).ready(function () {

        tablaUsuarios = new DataTable('#usuariosTable', {
            language: {
                url: 'https://cdn.datatables.net/plug-ins/2.1.3/i18n/es-ES.json'
            },
            pageLength: 10,
            lengthMenu: [5, 10, 25, 50, 100],
            order: [[0, 'desc']]
        });

        // Buscador en tiempo real
        $('#tablaBuscador').on('input', function () {
            tablaUsuarios.search(this.value).draw();
        });

    });
</script>
